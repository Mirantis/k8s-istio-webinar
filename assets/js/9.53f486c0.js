(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{145:function(t,e,s){t.exports=s.p+"assets/img/istio.a24267ed.svg"},253:function(t,e,s){"use strict";s.r(e);var a=s(2),r=Object(a.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"istio-installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#istio-installation","aria-hidden":"true"}},[t._v("#")]),t._v(" Istio - Installation")]),t._v(" "),a("p",[t._v("Istio architecture:")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/istio/istio.io/7bf371365e4a16a9a13c0e79355fe1eac7f8f99f/content/docs/concepts/what-is-istio/arch.svg?sanitize=true",alt:"Istio Architecture",title:"Istio Architecture"}})]),t._v(" "),a("h2",{attrs:{id:"install-istio"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-istio","aria-hidden":"true"}},[t._v("#")]),t._v(" Install Istio")]),t._v(" "),a("p",[t._v("Either download Istio directly from "),a("a",{attrs:{href:"https://github.com/istio/istio/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/istio/istio/releases"),a("OutboundLink")],1),t._v("\nor get the latest version by using curl:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("export")]),t._v(" ISTIO_VERSION"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.1.0"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),t._v(" -d tmp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" tmp\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cd")]),t._v(" tmp\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -sL https://git.io/getLatestIstio "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" sh -\n")])])]),a("p",[t._v("Output:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("Downloading istio-1.1.0 from https://github.com/istio/istio/releases/download/1.1.0/istio-1.1.0-linux.tar.gz "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   614    0   614    0     0    884      0 --:--:-- --:--:-- --:--:--   883\n100 15.0M  100 15.0M    0     0  5252k      0  0:00:02  0:00:02 --:--:-- 12.4M\nDownloaded into istio-1.1.0:\nLICENSE  README.md  bin  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("  istio.VERSION  samples  tools\nAdd /mnt/k8s-istio-webinar/k8s-istio-webinar/tmp/istio-1.1.0/bin to your path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" e.g copy "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("paste")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" your shell and/or ~/.profile:\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("export")]),t._v(" PATH"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PATH")]),t._v(':/mnt/k8s-istio-webinar/k8s-istio-webinar/tmp/istio-1.1.0/bin"')]),t._v("\n")])])]),a("p",[t._v("Change the directory to the Istio installation files location:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cd")]),t._v(" istio*\n")])])]),a("p",[t._v("Install "),a("code",[t._v("istioctl")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),t._v(" -x /usr/local/bin/istioctl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mv")]),t._v(" bin/istioctl /usr/local/bin/\n")])])]),a("p",[t._v("Install the "),a("code",[t._v("istio-init")]),t._v(" chart to bootstrap all the Istio's CRDs:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("helm "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" install/kubernetes/helm/istio-init --wait \\\n--name istio-init --namespace istio-system --set certmanager.enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" 30\n")])])]),a("p",[t._v("Install "),a("a",{attrs:{href:"https://istio.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Istio"),a("OutboundLink")],1),t._v(" with add-ons ("),a("a",{attrs:{href:"https://www.kiali.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Kiali"),a("OutboundLink")],1),t._v(",\n"),a("a",{attrs:{href:"https://www.jaegertracing.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jaeger"),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://grafana.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grafana"),a("OutboundLink")],1),t._v(",\n"),a("a",{attrs:{href:"https://prometheus.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Prometheus"),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://github.com/jetstack/cert-manager",target:"_blank",rel:"noopener noreferrer"}},[t._v("cert-manager"),a("OutboundLink")],1),t._v("):")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("helm "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" install/kubernetes/helm/istio --wait --name istio --namespace istio-system \\\n  --set certmanager.enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true \\\n  --set certmanager.email"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("petr.ruzicka@gmail.com \\\n  --set gateways.istio-ingressgateway.sds.enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true \\\n  --set global.k8sIngress.enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true \\\n  --set global.k8sIngress.enableHttps"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true \\\n  --set global.k8sIngress.gatewayName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ingressgateway \\\n  --set grafana.enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true \\\n  --set kiali.enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true \\\n  --set kiali.createDemoSecret"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true \\\n  --set kiali.contextPath"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ \\\n  --set kiali.dashboard.grafanaURL"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://grafana."),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MY_DOMAIN}")]),t._v("/ \\\n  --set kiali.dashboard.jaegerURL"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://jaeger."),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MY_DOMAIN}")]),t._v("/ \\\n  --set servicegraph.enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true \\\n  --set tracing.enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true\n")])])]),a("h2",{attrs:{id:"create-dns-records"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-dns-records","aria-hidden":"true"}},[t._v("#")]),t._v(" Create DNS records")]),t._v(" "),a("p",[t._v("Create DNS record "),a("code",[t._v("mylabs.dev")]),t._v(" for the loadbalancer created by Istio:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("export")]),t._v(" LOADBALANCER_HOSTNAME"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("kubectl get svc istio-ingressgateway -n istio-system -o jsonpath"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{.status.loadBalancer.ingress[0].hostname}"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("export")]),t._v(" CANONICAL_HOSTED_ZONE_NAME_ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("aws elb describe-load-balancers --query "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LoadBalancerDescriptions[?DNSName==\\'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("$LOADBALANCER_HOSTNAME\\"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v('].CanonicalHostedZoneNameID"')]),t._v(" --output text"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("export")]),t._v(" HOSTED_ZONE_ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("aws route53 list-hosted-zones --query "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HostedZones[?Name==\\'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("MY_DOMAIN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(".\\"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v('].Id"')]),t._v(" --output text"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n\nenvsubst "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/files/aws_route53-dns_change.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" aws route53 change-resource-record-sets --hosted-zone-id "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${HOSTED_ZONE_ID}")]),t._v(" --change-batch"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("file:///dev/stdin\n")])])]),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/aws-samples/eks-workshop/65b766c494a5b4f5420b2912d8373c4957163541/static/images/crystal.svg?sanitize=true",alt:"Architecture",title:"Architecture"}})]),t._v(" "),a("h2",{attrs:{id:"create-ssl-certificate-using-let-s-encrypt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-ssl-certificate-using-let-s-encrypt","aria-hidden":"true"}},[t._v("#")]),t._v(" Create SSL certificate using Let's Encrypt")]),t._v(" "),a("p",[t._v("Create "),a("code",[t._v("ClusterIssuer")]),t._v(" and "),a("code",[t._v("Certificate")]),t._v(" for Route53 used by cert-manager.\nIt will allow Let's encrypt to generate certificate. Route53 (DNS) method of\nrequesting certificate from Let's Encrypt must be used to create wildcard\ncertificate "),a("code",[t._v("*.mylabs.dev")]),t._v(" (details "),a("a",{attrs:{href:"https://community.letsencrypt.org/t/wildcard-certificates-via-http-01/51223",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(").")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("export")]),t._v(" EKS_CERT_MANAGER_ROUTE53_AWS_SECRET_ACCESS_KEY_BASE64"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" -n "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$EKS_CERT_MANAGER_ROUTE53_AWS_SECRET_ACCESS_KEY")]),t._v('"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" base64"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/files/cert-manager-letsencrypt-aws-route53-clusterissuer-certificate.yaml\nenvsubst "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/files/cert-manager-letsencrypt-aws-route53-clusterissuer-certificate.yaml "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" kubectl apply -f -\n")])])]),a("p",[a("img",{attrs:{src:"https://b3n.org/wp-content/uploads/2016/09/acme_letsencrypt_dns-01-challenge.png",alt:"ACME DNS Challenge",title:"ACME DNS Challenge"}})]),t._v(" "),a("p",[t._v("("),a("a",{attrs:{href:"https://b3n.org/intranet-ssl-certificates-using-lets-encrypt-dns-01/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://b3n.org/intranet-ssl-certificates-using-lets-encrypt-dns-01/"),a("OutboundLink")],1),t._v(")")]),t._v(" "),a("p",[t._v("Let "),a("code",[t._v("istio-ingressgateway")]),t._v(" to enable TLS certificates delivery via "),a("a",{attrs:{href:"https://www.envoyproxy.io/docs/envoy/latest/configuration/secret",target:"_blank",rel:"noopener noreferrer"}},[t._v("SDS"),a("OutboundLink")],1),t._v(":")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("kubectl -n istio-system patch gateway istio-autogenerated-k8s-ingress \\\n  --type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("json \\\n  -p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[{"')]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("op")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v("replace"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v("path"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v("/spec/servers/1/tls"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v("value"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('": {"')]),t._v("credentialName"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v("ingress-cert-"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${LETSENCRYPT_ENVIRONMENT}")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v("mode"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v("SIMPLE"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v("privateKey"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v("sds"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('", "')]),t._v("serverCertificate"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v("sds"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"}}]"')]),t._v("\n")])])]),a("h2",{attrs:{id:"check-and-configure-istio"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#check-and-configure-istio","aria-hidden":"true"}},[t._v("#")]),t._v(" Check and configure Istio")]),t._v(" "),a("p",[t._v("Allow the "),a("code",[t._v("default")]),t._v(" namespace to use Istio injection:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("kubectl label namespace default istio-injection"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("enabled\n")])])]),a("p",[t._v("Check namespaces:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("kubectl get namespace -L istio-injection\n")])])]),a("p",[t._v("Output:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("NAME           STATUS   AGE   ISTIO-INJECTION\ndefault        Active   19m   enabled\nistio-system   Active   7m\nkube-public    Active   19m\nkube-system    Active   19m\n")])])]),a("p",[t._v("See the Istio components:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("kubectl get --namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("istio-system svc,deployment,pods,job,horizontalpodautoscaler,destinationrule\n")])])]),a("p",[t._v("Output:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("NAME                             TYPE           CLUSTER-IP       EXTERNAL-IP                                                                  PORT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("S"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("                                                                                                                                      AGE\nservice/grafana                  ClusterIP      10.100.84.93     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       3000/TCP                                                                                                                                     7m\nservice/istio-citadel            ClusterIP      10.100.203.5     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       8060/TCP,15014/TCP                                                                                                                           7m\nservice/istio-galley             ClusterIP      10.100.224.231   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       443/TCP,15014/TCP,9901/TCP                                                                                                                   7m\nservice/istio-ingressgateway     LoadBalancer   10.100.241.162   abd0be556520611e9ac0602dc9c152bf-2144127322.eu-central-1.elb.amazonaws.com   80:31380/TCP,443:31390/TCP,31400:31400/TCP,15029:31705/TCP,15030:30101/TCP,15031:30032/TCP,15032:32493/TCP,15443:31895/TCP,15020:31909/TCP   7m\nservice/istio-pilot              ClusterIP      10.100.68.4      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       15010/TCP,15011/TCP,8080/TCP,15014/TCP                                                                                                       7m\nservice/istio-policy             ClusterIP      10.100.24.13     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       9091/TCP,15004/TCP,15014/TCP                                                                                                                 7m\nservice/istio-sidecar-injector   ClusterIP      10.100.252.24    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       443/TCP                                                                                                                                      7m\nservice/istio-telemetry          ClusterIP      10.100.103.164   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       9091/TCP,15004/TCP,15014/TCP,42422/TCP                                                                                                       7m\nservice/jaeger-agent             ClusterIP      None             "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       5775/UDP,6831/UDP,6832/UDP                                                                                                                   7m\nservice/jaeger-collector         ClusterIP      10.100.32.192    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       14267/TCP,14268/TCP                                                                                                                          7m\nservice/jaeger-query             ClusterIP      10.100.196.113   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       16686/TCP                                                                                                                                    7m\nservice/kiali                    ClusterIP      10.100.66.131    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       20001/TCP                                                                                                                                    7m\nservice/prometheus               ClusterIP      10.100.246.253   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       9090/TCP                                                                                                                                     7m\nservice/servicegraph             ClusterIP      10.100.163.157   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       8088/TCP                                                                                                                                     7m\nservice/tracing                  ClusterIP      10.100.90.197    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       80/TCP                                                                                                                                       7m\nservice/zipkin                   ClusterIP      10.100.8.55      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                                                                       9411/TCP                                                                                                                                     7m\n\nNAME                                           DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE\ndeployment.extensions/certmanager              1         1         1            1           7m\ndeployment.extensions/grafana                  1         1         1            1           7m\ndeployment.extensions/istio-citadel            1         1         1            1           7m\ndeployment.extensions/istio-galley             1         1         1            1           7m\ndeployment.extensions/istio-ingressgateway     1         1         1            1           7m\ndeployment.extensions/istio-pilot              1         1         1            1           7m\ndeployment.extensions/istio-policy             1         1         1            1           7m\ndeployment.extensions/istio-sidecar-injector   1         1         1            1           7m\ndeployment.extensions/istio-telemetry          1         1         1            1           7m\ndeployment.extensions/istio-tracing            1         1         1            1           7m\ndeployment.extensions/kiali                    1         1         1            1           7m\ndeployment.extensions/prometheus               1         1         1            1           7m\ndeployment.extensions/servicegraph             1         1         1            1           7m\n\nNAME                                          READY   STATUS      RESTARTS   AGE\npod/certmanager-7478689867-6n8r7              1/1     Running     0          7m\npod/grafana-7b46bf6b7c-w7ms2                  1/1     Running     0          7m\npod/istio-citadel-75fdb679db-v8bqh            1/1     Running     0          7m\npod/istio-galley-c864b5c86-8xfpm              1/1     Running     0          7m\npod/istio-ingressgateway-6cb65d86cb-5ptgp     2/2     Running     0          7m\npod/istio-init-crd-10-stcw2                   0/1     Completed   0          7m\npod/istio-init-crd-11-fgdh9                   0/1     Completed   0          7m\npod/istio-init-crd-certmanager-10-rhmv9       0/1     Completed   0          7m\npod/istio-init-crd-certmanager-11-dv24d       0/1     Completed   0          7m\npod/istio-pilot-f4c98cfbf-pwp45               2/2     Running     0          7m\npod/istio-policy-6cbbd844dd-4dzbx             2/2     Running     2          7m\npod/istio-sidecar-injector-7b47cb4689-5x7ph   1/1     Running     0          7m\npod/istio-telemetry-ccc4df498-w77hk           2/2     Running     2          7m\npod/istio-tracing-75dd89b8b4-frg8w            1/1     Running     0          7m\npod/kiali-7787748c7d-lb454                    1/1     Running     0          7m\npod/prometheus-89bc5668c-54pdj                1/1     Running     0          7m\npod/servicegraph-5d4b49848-cscbp              1/1     Running     1          7m\n\nNAME                                      DESIRED   SUCCESSFUL   AGE\njob.batch/istio-init-crd-10               1         1            7m\njob.batch/istio-init-crd-11               1         1            7m\njob.batch/istio-init-crd-certmanager-10   1         1            7m\njob.batch/istio-init-crd-certmanager-11   1         1            7m\n\nNAME                                                       REFERENCE                         TARGETS         MINPODS   MAXPODS   REPLICAS   AGE\nhorizontalpodautoscaler.autoscaling/istio-ingressgateway   Deployment/istio-ingressgateway   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("unknown"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/80%   1         5         1          7m\nhorizontalpodautoscaler.autoscaling/istio-pilot            Deployment/istio-pilot            "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("unknown"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/80%   1         5         1          7m\nhorizontalpodautoscaler.autoscaling/istio-policy           Deployment/istio-policy           "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("unknown"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/80%   1         5         1          7m\nhorizontalpodautoscaler.autoscaling/istio-telemetry        Deployment/istio-telemetry        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("unknown"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/80%   1         5         1          7m\n\nNAME                                                  HOST                                             AGE\ndestinationrule.networking.istio.io/istio-policy      istio-policy.istio-system.svc.cluster.local      7m\ndestinationrule.networking.istio.io/istio-telemetry   istio-telemetry.istio-system.svc.cluster.local   7m\n")])])]),a("p",[t._v("Configure the Istio services ("),a("a",{attrs:{href:"https://www.jaegertracing.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jaeger"),a("OutboundLink")],1),t._v(",\n"),a("a",{attrs:{href:"https://prometheus.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Prometheus"),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://grafana.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grafana"),a("OutboundLink")],1),t._v(",\n"),a("a",{attrs:{href:"https://www.kiali.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Kiali"),a("OutboundLink")],1),t._v(", Servicegraph) to be visible externally:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("envsubst "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/files/export_services_gateway.yaml "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" kubectl apply -f -\n")])])]),a("p",[a("img",{attrs:{src:s(145),alt:"Istio",title:"Istio"}})])])},[],!1,null,null,null);e.default=r.exports}}]);